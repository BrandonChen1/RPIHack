<!DOCTYPE html>
<html lang="en">

<style>

</style>
<head>
    <meta charset="UTF-8">
    <title id = "ChatroomID">ChatRoom</title>
</head>
<body>
<div id = "loginPage">
    <p id = "error"></p>
    <form id = "loginForm">
        <p> Enter a Username </p>
        <input size = "35" type = "text" id = "username" autocomplete = "off" required>
        <p> Enter a University ID</p>
        <input size = "35" type = "text" id = "UID" autocomplete = "off" required>
        <p>Are you a teacher or a student?</p>
        <input type="radio" name="ts" value="teacher" required> Teacher<br>
        <input type="radio" name="ts" value="student" required> Student<br>
        <input type = "submit">
    </form>
</div>

<div id = "TeacherCreate">
    Create a Room
    <form id = "CreateRoom">
        <input size ='25' id = 'CreateID'>
        <input type ="submit">
    </form>
</div>
<div id = "RoomID">
    <form id="RoomS">
        <br> Join A Room </br>
        <input id = "RoomSubmit">
        <input type = "submit">
    </form>

</div>
<div id = 'chat'>
    <form id="send-message">
        <input size = "35" id = "message">
        <input type = "submit">
    </form>
</div>
</body>
<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
<script>
    jQuery(function($){
        var socket = io.connect();
        var RoomID = $('#RoomID');
        var RoomS = $('#RoomS');
        var RoomSubmit = $('#RoomSubmit');
        var sendmsg = $('#send-message');
        var msg = $('#message');
        var chatbox = $('#chat');
        var CreateRoom = $('#CreateRoom');
        var TeacherCreate = $('#TeacherCreate');
        var CreateID = $('#CreateID');
        var $userSubmit = $('#loginForm');
        var $error = $('#error');
        var $user = $('#username');
        var $UID = $('#UID');
        var $login = $('#loginPage');
        var $classes = $('#Classes');


        chatbox.hide();
        TeacherCreate.hide();
        RoomID.hide();
        //Creating a room to the server

        $userSubmit.submit(function(e){
            e.preventDefault();
            socket.emit('new user', $user.val(), $UID.val(), function(user, UID){
                if($('input[name=ts]:checked') && user){
                    $login.hide();
                    if($('input[name=ts]:checked').val()  == "student"){
                        RoomID.show();
                    }
                    else{
                        TeacherCreate.show();
                    }
                }
                else{
                    $error.html('That username is already taken.');
                }
            });
            $userSubmit.val('');
            $UID.val('');
        });


        CreateRoom.submit(function(e){
            e.preventDefault();
            socket.emit('Create-Room',CreateID.val());
        });

        //Submitting a room to the server
        RoomS.submit(function(e){
            e.preventDefault();
            socket.emit('Join-Room',RoomSubmit.val());

        });

        msg.submit(function(e){
            e.preventDefault();
            socket.emit('Send-message', sendmsg.val());
        });

        socket.on('Invalid-Room',function(data){

        });

        socket.on('Valid-Room',function(data){
            socket.ID = data.toString();
            console.log('Receive valid room');
            RoomID.hide();
            chatbox.show();
        });

        socket.on('Receive-message',function(data){
            msg.append(data+ "<br/>");
        });

        socket.on('Create-Good',function(data){
            socket.ID = data.toString();
            TeacherCreate.hide();
            chatbox.show();
        });









    })
</script>
</html>